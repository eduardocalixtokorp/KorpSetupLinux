# https://docs.ansible.com/ansible/latest/collections/community/general/mssql_script_module.html#ansible-collections-community-general-mssql-script-module

- name: debug
  debug:
    msg:
    - "ServiceName: {{ service_name }}"
    - "Secret: {{ secret }}"

- name: sql querys
  vars:
    table: Packages
  community.general.mssql_script:
    login_user: "{{ mssql_login_user }}"
    login_password: "{{ mssql_login_password }}"
    login_host: "{{ mssql_host }}"
    # login_port: "{{ mssql_port }}"
    db: Viasoft_Portal
    output: dict
    script: '{{ lookup("template", "files/query.j2") }}'
  register: result
